<div class="container d-flex card shadow-sm" *ngIf="statePersonGroup == 1">
    <div class="row" *ngIf="eventGroupForm.get('estadoEvento')?.value == 1">
        <div class="especial" *ngIf="actualDate < dateTerminate">
            <div class="row">
                <img [src]="eventGroupForm.get('imagen')?.value" alt="" id="imagenGrupo">
            </div>
            <div class="row">
                <h2 class="titlePrincipal">{{eventGroupForm.get('nombreEvento')?.value}}</h2>
            </div>

            <div class="row">

                <div class="col-3 colum">
                    <div class="row">
                        <p class="textoTitulos">Participantes</p>
                    </div>
                    <div class="row">
                        <h4 class="textox">{{totalPersonsIn}}</h4>
                    </div>
                </div>

                <div class="col-3 colum">
                    <div class="row">
                        <p class="textoTitulos">Aforo del evento</p>
                    </div>
                    <div class="row">
                        <h4 class="textox">{{eventGroupForm.get('participantesTotales')?.value}}</h4>
                    </div>

                </div>

                <div class="col-3 colum">
                    <div class="row">
                        <h4 class="textoTitulos">Rol</h4>
                    </div>
                    <div class="row">
                        <p class="textox" *ngIf="statePersonGroup == 1">Organizador</p>
                        <p class="textox" *ngIf="statePersonGroup >= 2">Participante</p>
                    </div>
                </div>

                <div class="col-3 colum">
                    <div *ngIf="actualDate < dateEvent; else nodate">
                        <button class="btn btnEditar textox" (click)="editEvent(eventGroupForm.get('idEvento')?.value)">
                    Editar
                </button>
                    </div>
                    <ng-template #nodate>
                        <button class="btnEditar2 textox" [disabled]="true">
                    Editar
                </button>
                    </ng-template>
                </div>

            </div>

            <div class="row">
                <div class="col-4 colum">
                    <div class="row">
                        <h4 class="textoTitulos">Fecha del evento:</h4>
                    </div>
                    <div class="row">
                        <p class="textox">{{eventGroupForm.get('fechaEvento')?.value}}</p>
                    </div>
                </div>
                <div class="col-4 colum">
                    <div class="row">
                        <h4 class="textoTitulos">Tipo de evento:</h4>
                    </div>
                    <div class="row">
                        <p class="textox">{{eventGroupForm.get('tipoEvento')?.value}}</p>
                    </div>
                </div>
                <div class="col-4 colum">
                    <div class="row">
                        <h4 class="textoTitulos">Lugar de realizacion o enlace:</h4>
                    </div>
                    <div class="row">
                        <p class="textox">{{eventGroupForm.get('direccion')?.value}}</p>
                    </div>
                </div>
            </div>
            <div class="row">
                <h4 class="textoTitulos">Descripcion</h4>

            </div>
            <div class="row">
                <p class="textox">{{eventGroupForm.get('descripcionEvento')?.value}}</p>
            </div>
            <div class="row">
                <h1 class="tituloP">Añadir un proveedor</h1>
            </div>

            <div class="row">
                <app-event-provider [idEvento]="eventGroupForm.get('idEvento')?.value" [terminate]="terminate" [form]="eventGroupForm.value"></app-event-provider>
            </div>

        </div>
        <div class="row textoTitulos" *ngIf="actualDate > dateTerminate">
            EVENTO COMPLETADO O ALCANZADO FECHA DE REALIZACION.
            <div class="table-provider">
                <app-event-provider [idEvento]="eventGroupForm.get('idEvento')?.value" [terminate]="terminate" [form]="eventGroupForm.value"></app-event-provider>
            </div>
        </div>
    </div>
    <div style="border:0" *ngIf="eventGroupForm.get('estadoEvento')?.value == 0">
        <h2 style="border:0!important" class="textoTitulos">EVENTO DESHABILITADO, SEA PACIENTE, MIENTRAS ESTE ES HABILITADO.</h2>
    </div>
    <div *ngIf="eventGroupForm.get('estadoEvento')?.value == 3">
        <h2 class="textoTitulos">EVENTO TERMINADO O INEXISTENTE, SI DESEA PODRA CREAR UN EVENTO NUEVO.</h2>
        <button class="btnEditar textox" data-bs-toggle="modal2" data-bs-target="#content-modal2" role="button" (click)="modalOpen2(content2)">Crear Evento</button>
    </div>

</div>
<div *ngIf="statePersonGroup == 2">
    <div *ngIf="this.eventGroupForm.get('estadoEvento')?.value == 0 || eventGroupForm.get('estadoEvento')?.value == 3">
        <h2>En este momento no se encuentra un evento, sea paciente mientras el organizador crea un evento.</h2>
    </div>

    <div class="container d-flex card shadow-sm" *ngIf="eventGroupForm.get('estadoEvento')?.value == 1">
        <div class="row" *ngIf="existPerson == 1">
            <div class="especial" *ngIf="actualDate < dateTerminate">

                <div class="row">
                    <img [src]="eventGroupForm.get('imagen')?.value" alt="Evento Danza" id="imagenGrupo">
                </div>
                <div class="row">

                    <h2 class="tituloP">{{eventGroupForm.get('nombreEvento')?.value}}</h2>

                </div>

                <div class="row">
                    <div class="col-4 colum">
                        <div class="row">
                            <p class="textoTitulos">Participantes</p>
                        </div>
                        <div class="row">
                            <h4 class="textox">{{totalPersonsIn}}</h4>

                        </div>
                    </div>
                    <div class="col-4 colum">
                        <div class="row">
                            <p class="textoTitulos">Organizador</p>

                        </div>
                        <div class="row">
                            <h4 class="textox">Dylan Murillo Rios</h4>
                        </div>
                    </div>
                    <div class="col-4 colum">
                        <div class="row">
                            <p class="textoTitulos">Fecha de creación</p>
                        </div>
                        <div class="row">
                            <h4 class="textox">25-02-2022</h4>
                        </div>
                    </div>

                </div>
                <div class="row">
                    <div class="col-4 colum">
                        <div class="row">
                            <h4 class="textoTitulos">Fecha de realización del evento:</h4>
                        </div>
                        <div class="row">
                            <p class="textox">{{eventGroupForm.get('fechaEvento')?.value}}</p>
                        </div>
                    </div>
                    <div class="col-4 colum">
                        <div class="row">
                            <h4 class="textoTitulos">Tipo de evento:</h4>
                        </div>
                        <div class="row">
                            <p class="textox">{{eventGroupForm.get('tipoEvento')?.value}}</p>
                        </div>
                    </div>
                    <div class="col-4 colum">
                        <div class="row">
                            <h4 class="textoTitulos">Lugar de realizacion:</h4>
                        </div>
                        <div class="row">
                            <p class="textox">Parque de la milagrosa - Cl. 43, Medellín, Antioquia</p>
                        </div>
                    </div>

                    <div class="row">
                        <h4 class="textoTitulos">Descripción</h4>
                    </div>
                    <div class="row">
                        <p class="textox">{{eventGroupForm.get('descripcionEvento')?.value}}</p>
                    </div>
                </div>


            </div>

            <div class="textoTitulos" *ngIf="actualDate >= dateTerminate">
                EVENTO TERMINADO, PORFAVOR ESPERE A QUE SEA CREADO UN NUEVO EVENTO.
            </div>
        </div>
        <div class="textoTitulos" *ngIf="existPerson === 2">
            <div *ngIf="totalPersonsIn < aforo">
                <h2 class="textoTitulos">¿Desea Participar en el evento?</h2>
                <button class="btn btnEditar2" (click)="postJoinEvent()">UNIRSE</button>
            </div>
            <div class="textoTitulos" *ngIf="totalPersonsIn >= aforo">
                EN ESTE MOMENTO EL EVENTO CUENTA CON UN AFORO LLENO, PORFAVOR SEA PACIENTE SI SON GENERADAS NUEVAS PLAZAS.
            </div>
        </div>

    </div>
</div>

<ng-template #content2 let-modal2>
    <!-- <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button> -->
    <form [formGroup]="createEventForm" (ngSubmit)="postForm(createEventForm.value)">
        <mat-datepicker class="modal" #picker style="z-index: 1000;"></mat-datepicker>
        <div class="modal-dialog modal-lg modal-dialog-scrollable">
            <button class="textox" type="button" class="btn-close" aria-label="Close" (click)="modal2.dismiss('Cross click')"></button>
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="titlePrincipal" id="staticBackdropLabel">Creacion de eventos</h5>
                </div>
                <div class="modal-body">
                    <div class="form">
                        <div class="grupoForm">
                            <label class="textoTitulos" for="">Nombre del Evento:</label>
                            <input class="textox" type="text" class="form-control" id="nombreEvento" placeholder="Ej: El mejor evento" formControlName="nombreEvento" [ngClass]="
                          (createEventForm.get('nombreEvento')?.touched || createEventForm.get('nombreEvento')?.dirty) &&
                          createEventForm.get('nombreEvento')?.hasError('required') ? 'is-invalid' : '' || createEventForm.get('nombreEvento')?.hasError('minlength')
                                      ? 'is-invalid' : '' || createEventForm.get('nombreEvento')?.hasError('maxlength')
                                      ? 'is-invalid' : ''">
                            <div class="textox invalid-feedback">
                                {{ createEventForm.get("nombreEvento")?.hasError("required") ? "Nombre requerido" : "" }} {{ createEventForm.get("nombreEvento")?.hasError("minlength") ? "Campo mínimo de 2 carácteres" : "" }} {{ createEventForm.get("nombreEvento")?.hasError("maxlength")
                                ? "Campo maximo de 30 carácteres" : "" }}
                            </div>
                        </div>

                        <div class="groupForm">
                            <label class="textoTitulos" for="">Tipo de Evento:</label>
                            <div class="form-check">
                                <input class="textox" class="form-check-input" type="radio" name="flexRadioDefault" id="flexRadioDefault1" [ngClass]="
                                      (createEventForm.get('tipoEvento')?.touched || createEventForm.get('tipoEvento')?.dirty) &&
                                          createEventForm.get('tipoEvento')?.errors ? 'is-invalid' : ''" formControlName="tipoEvento" name="tipoEvento" value="presencial" checked>
                                <label class="textox" class="form-check-label" for="flexRadioDefault1">
                                          Presencial
                                      </label>
                            </div>
                            <div class="form-check">
                                <input class="form-check-input textox" type="radio" name="flexRadioDefault" id="flexRadioDefault2" [ngClass]="
                                      (createEventForm.get('tipoEvento')?.touched || createEventForm.get('tipoEvento')?.dirty) &&
                                          createEventForm.get('tipoEvento')?.errors ? 'is-invalid' : ''" formControlName="tipoEvento" name="tipoEvento" value="virtual">
                                <label class="textox form-check-label" for="flexRadioDefault2">
                                          Virtual
                                      </label>
                            </div>
                            <div class="textox invalid-feedback">
                                {{ createEventForm.get("tipoEvento")?.hasError("required") ? "Tipo Requerido" : "" }}
                            </div>
                        </div>

                        <div class="groupForm">
                            <label class="textoTitulos" for="">Imagen evento:</label>
                            <div class="mb-2">
                                <input (change)="capturarFile($event)" type="file" [ngClass]="
                              (createEventForm.get('imagen')?.touched || createEventForm.get('imagen')?.dirty) &&
                                  createEventForm.get('imagen')?.errors ? 'is-invalid' : ''" formControlName="imagen">
                            </div>
                            <h4 class="textox">PREVISUALIZACION</h4>
                            <div *ngIf="previsualizacion">
                                <img class="imgCe" [src]="previsualizacion" alt="">
                            </div>
                            <div class="textox invalid-feedback">
                                {{ createEventForm.get("imagen")?.hasError("required") ? "Imagen requerida" : "" }}
                            </div>
                        </div>

                        <div class="groupForm">
                            <label class="textoTitulos" for="">Descripcion Evento:</label>
                            <textarea class="form-control textox" type="text" id="descripcionEvento" formControlName="descripcionEvento" placeholder="Explica de que tratará y dónde será." rows="2" [ngClass]="
                              (createEventForm.get('descripcionEvento')?.touched || createEventForm.get('descripcionEvento')?.dirty) &&
                              createEventForm.get('descripcionEvento')?.hasError('required')
                              ? 'is-invalid' : '' || createEventForm.get('descripcionEvento')?.hasError('minlength')
                              ? 'is-invalid' : '' || createEventForm.get('descripcionEvento')?.hasError('maxlength')
                              ? 'is-invalid' : ''"></textarea>
                            <div class="textox invalid-feedback">
                                {{ createEventForm.get("descripcionEvento")?.hasError("required") ? "Descripcion requerida" : "" }} {{ createEventForm.get("descripcionEvento")?.hasError("minlength") ? "Campo mínimo de 10 carácteres" : "" }} {{ createEventForm.get("descripcionEvento")?.hasError("maxlength")
                                ? "Campo maximo de 500 carácteres" : "" }}
                            </div>
                        </div>
                        <!-- {{createEventForm.get("descripcionEvento")?.errors | json}} -->

                        <div class="groupForm">
                            <label class="textoTitulos" for="">Dirección o enlace del Evento:</label>
                            <textarea class="form-control textox" type="text" id="descripcionEvento" formControlName="direccion" placeholder="Explica donde sera realizado el evento, o deja el enlace si se trata de un evento VIRTUAL" rows="2" [ngClass]="
                          (createEventForm.get('direccion')?.touched || createEventForm.get('direccion')?.dirty) &&
                          createEventForm.get('direccion')?.hasError('required')
                          ? 'is-invalid' : '' || createEventForm.get('direccion')?.hasError('minlength')
                          ? 'is-invalid' : '' || createEventForm.get('direccion')?.hasError('maxlength')
                          ? 'is-invalid' : ''"></textarea>
                            <div class="invalid-feedback textox">
                                {{ createEventForm.get("direccion")?.hasError("required") ? "Dirección o enlace requerido" : "" }} {{ createEventForm.get("direccion")?.hasError("minlength") ? "Campo mínimo de 10 carácteres" : "" }} {{ createEventForm.get("direccion")?.hasError("maxlength")
                                ? "Campo maximo de 150 carácteres" : "" }}
                            </div>
                        </div>

                        <div class="groupForm">
                            <label class="textoTitulos" for="">Fecha Realizacion:</label>
                            <input type="date" class="form-control textox" [ngClass]="
                              (createEventForm.get('fechaEvento')?.touched || createEventForm.get('fechaEvento')?.dirty) &&
                                  createEventForm.get('fechaEvento')?.hasError('required') ? 'is-invalid' : ''" formControlName="fechaEvento" value="{{dateS}}" min="{{dateS}}">
                            <div class="invalid-feedback textox">
                                {{ createEventForm.get("fechaEvento")?.hasError("required") ? " Fecha requerida" : "" }}
                            </div>
                            <style>
                                 ::ng-deep .cdk-overlay-container {
                                    z-index: 2000;
                                }
                            </style>

                        </div>

                        <div class="groupForm">
                            <label for="exampleInputEmail1 textoTitulos">Numero Participantes maximo:</label>
                            <input class="textox" type="number" class="form-control" id="exampleInputEmail1" min="2" max="200" [ngClass]="
                                  (createEventForm.get('participantesTotales')?.touched || createEventForm.get('participantesTotales')?.dirty) &&
                                      createEventForm.get('participantesTotales')?.hasError('required')
                                      ? 'is-invalid' : '' || createEventForm.get('participantesTotales')?.hasError('min')
                                      ? 'is-invalid' : '' || createEventForm.get('participantesTotales')?.hasError('max')
                                      ? 'is-invalid' : ''" formControlName="participantesTotales">

                            <div class="invalid-feedback textox">
                                {{ createEventForm.get("participantesTotales")?.hasError("required") ? " Numero de participantes requeridos" : "" }} {{ createEventForm.get("participantesTotales")?.hasError("min") ? "Minimo 2 participantes" : "" }} {{ createEventForm.get("participantesTotales")?.hasError("max")
                                ? "Maximo 200 participantes" : "" }}
                            </div>
                        </div>

                        <div class="groupForm">
                            <input type="checkbox" checked name="" id="check" formControlName="check" [ngClass]="(createEventForm.get('check')?.touched || createEventForm.get('check')?.dirty) &&
                          createEventForm.get('check')?.errors ? 'is-invalid' : ''">
                            <label class="textox">Aceptas 1480 de 2011 articulo 30 sobre contenido explicito.</label>
                            <div class="invalid-feedback textox">
                                {{ createEventForm.get("check")?.hasError("required") ? "Debe estar de acuerdo con las políticas." : "" }}
                            </div>
                        </div>
                    </div>


                </div>
                <div class="modal-footer">
                    <button type="submit" class="textox btn btnEditar" [disabled]="createEventForm.invalid" data-bs-dismiss="modal">Crear evento</button>
                </div>
            </div>


        </div>
    </form>
    <!-- <app-modal-disable-event [idEvent]="eventGroupForm.get('idEvento')?.value" [form]="eventGroupForm.value"></app-modal-disable-event> -->
</ng-template>

<ng-template #content let-modal>
    <button type="button" class="btn-close" aria-label="Close" (click)="modal.dismiss('Cross click')"></button>
    <app-modal-disable-event [idEvento]="eventGroupForm.get('idEvento')?.value" [form]="eventGroupForm.value"></app-modal-disable-event>
</ng-template>
